% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correlatePhiSpace.R
\name{correlatePhiSpace}
\alias{correlatePhiSpace}
\title{Correlate PhiSpace scores with a response variable}
\usage{
correlatePhiSpace(
  spe,
  response,
  method = c("PLSDA", "PLS", "DWD"),
  ncomp = NULL,
  reducedDimName = "PhiSpace",
  center = TRUE,
  scale = FALSE,
  dwd_params = list(),
  seed = NULL
)
}
\arguments{
\item{spe}{A SpatialExperiment or SingleCellExperiment object containing
PhiSpace scores in reducedDim}

\item{response}{Either a character string specifying a column name in colData(spe),
or a vector of response values. For classification methods (PLSDA, DWD),
this should be a factor or will be coerced to a factor.}

\item{method}{Character string specifying the analysis method. One of:
\itemize{
\item "PLS" - Partial Least Squares regression (for continuous response)
\item "PLSDA" - Partial Least Squares Discriminant Analysis (for discrete response)
\item "DWD" - Distance Weighted Discrimination (for binary classification)
}}

\item{ncomp}{Integer specifying the number of components to use.
If NULL (default), will be set automatically based on the method:
\itemize{
\item For PLSDA: number of classes - 1
\item For PLS: min(10, ncol(PhiSpace)/2)
\item For DWD: not applicable (DWD finds a single discriminant direction)
}}

\item{reducedDimName}{Character string specifying which reducedDim slot
contains the PhiSpace scores. Default is "PhiSpace".}

\item{center}{Logical indicating whether to center the PhiSpace scores
before analysis. Default is TRUE.}

\item{scale}{Logical indicating whether to scale the PhiSpace scores
before analysis. Default is FALSE.}

\item{dwd_params}{List of additional parameters for DWD (only used if method="DWD"):
\itemize{
\item kernel: kernel function (default: vanilladot())
\item qval: q-value parameter for DWD (default: 1)
\item lambda: regularization parameter or sequence (default: auto-tuned via CV)
\item cv_folds: number of cross-validation folds (default: 5)
}}

\item{seed}{Integer seed for reproducibility. Default is NULL (no seed set).}
}
\value{
A list with class "PhiSpaceCorrelation" containing:
\item{method}{The method used}
\item{importance_scores}{Matrix of feature importance scores (coefficients or weights)}
\item{scores}{Predicted scores or component scores for each observation}
\item{model}{The fitted model object}
\item{feature_ranking}{Data frame with features ranked by importance}
\item{response_summary}{Summary information about the response variable}
\item{parameters}{List of parameters used in the analysis}
}
\description{
This function performs regression or classification analysis to identify
which PhiSpace cell state scores are most associated with a response variable.
It supports both continuous (regression) and discrete (classification) responses
using various methods including PLS, PLSDA, and DWD.
}
\details{
\strong{Method Selection:}
\itemize{
\item Use \strong{PLS} for continuous responses (e.g., survival time, gene expression)
\item Use \strong{PLSDA} for multi-class classification (e.g., disease subtypes, clusters)
\item Use \strong{DWD} for binary classification when interpretability is important
}

\strong{Feature Importance:}
\itemize{
\item For PLS/PLSDA: regression coefficients from the final component
\item For DWD: the discriminant weights
}

The importance scores indicate which cell state features (PhiSpace dimensions)
are most strongly associated with the response. Positive values indicate
positive association, negative values indicate negative association.
}
\examples{
\dontrun{
# PLSDA example: associate PhiSpace scores with clusters
result <- correlatePhiSpace(
  spe = query_spe,
  response = "PhiClust",
  method = "PLSDA"
)

# View top important features
head(result$feature_ranking, 10)

# Plot importance scores
plot(result, nfeat = 20)

# PLS example: associate with a continuous variable
result <- correlatePhiSpace(
  spe = query_spe,
  response = "spatial_distance",
  method = "PLS",
  ncomp = 5
)

# DWD example: binary classification
result <- correlatePhiSpace(
  spe = query_spe,
  response = "cancer_vs_normal",
  method = "DWD",
  dwd_params = list(qval = 1, cv_folds = 10)
)
}

}
