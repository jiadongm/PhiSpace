% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rankFeatures.R
\name{rankFeatures}
\alias{rankFeatures}
\title{Rank Features by Discriminative Power}
\usage{
rankFeatures(
  data,
  response,
  method = c("PLSDA", "PLS", "DWD"),
  source = c("reducedDim", "assay"),
  assay_name = "logcounts",
  reducedDim_name = "PhiSpace",
  ncomp = NULL,
  center = TRUE,
  scale = FALSE,
  dwd_params = list(),
  seed = NULL
)
}
\arguments{
\item{data}{A matrix or data.frame where rows are observations and columns
are features. Can also be a SpatialExperiment, SingleCellExperiment, or
SummarizedExperiment object.}

\item{response}{Either a character string specifying a column name in colData
(when \code{data} is an experiment object), or a vector of response values.
For classification (PLSDA, DWD), should be factor or character.
For regression (PLS), should be numeric.}

\item{method}{Character string specifying the method: "PLSDA" for classification,
"PLS" for regression, or "DWD" for binary classification. Default is "PLSDA".}

\item{source}{Character string specifying data source when \code{data} is an
experiment object: "assay" or "reducedDim". Default is "reducedDim".}

\item{assay_name}{Character string specifying which assay to use when
\code{source = "assay"}. Default is "logcounts".}

\item{reducedDim_name}{Character string specifying which reduced dimension
to use when \code{source = "reducedDim"}. Default is "PhiSpace".}

\item{ncomp}{Integer specifying number of components. If NULL (default),
set automatically: number of classes for PLSDA, min(10, ncol(data)/2) for PLS.
Not used for DWD.}

\item{center}{Logical indicating whether to center features. Default is TRUE.}

\item{scale}{Logical indicating whether to scale features. Default is FALSE.}

\item{dwd_params}{List of parameters for DWD method (see Details).}

\item{seed}{Integer seed for reproducibility. Default is NULL.}
}
\value{
A list with class "FeatureRanking" containing:
\item{method}{The method used}
\item{importance_scores}{Matrix of feature importance scores}
\item{scores}{Component or discriminant scores for observations}
\item{model}{The fitted model object}
\item{feature_ranking}{Data frame with features ranked by importance}
\item{response_summary}{Summary of the response variable}
\item{parameters}{List of parameters used}
}
\description{
Uses supervised learning methods (PLS-DA, PLS, or DWD) to rank features by
their ability to discriminate between groups or predict a continuous response.
Based on PhiSpace's correlatePhiSpace but generalized to work with any
numeric data (not just PhiSpace scores).
}
\details{
\strong{Methods:}
\itemize{
\item \strong{PLSDA}: Partial Least Squares Discriminant Analysis for
multi-class classification. Features ranked by coefficient magnitude.
\item \strong{PLS}: Partial Least Squares regression for continuous response.
Features ranked by coefficient magnitude.
\item \strong{DWD}: Distance Weighted Discrimination for binary classification.
Features ranked by discriminant weights.
}

\strong{DWD Parameters} (in \code{dwd_params} list):
\itemize{
\item \code{kernel}: Kernel function (default: vanilladot())
\item \code{qval}: q-value parameter (default: 1)
\item \code{lambda}: Regularization parameter or sequence (default: auto-tuned)
\item \code{cv_folds}: Cross-validation folds (default: 5)
}
}
\examples{
\dontrun{
# With matrix input - PLSDA
expr_mat <- t(assay(spe, "logcounts"))
result <- rankFeatures(expr_mat, response = spe$cluster, method = "PLSDA")
head(result$feature_ranking, 10)

# With experiment object - from assay
result <- rankFeatures(spe, response = "cluster", method = "PLSDA",
                       source = "assay", assay_name = "logcounts")

# From reduced dimensions (e.g., PhiSpace scores)
result <- rankFeatures(spe, response = "cluster", method = "PLSDA",
                       source = "reducedDim", reducedDim_name = "PhiSpace")

# PLS for continuous response
result <- rankFeatures(expr_mat, response = spe$spatial_score, method = "PLS")

# DWD for binary classification
result <- rankFeatures(expr_mat, response = spe$treatment, method = "DWD")
}

}
