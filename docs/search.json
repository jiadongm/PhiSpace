[{"path":"https://jiadongm.github.io/PhiSpace/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 PhiSpace authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jiadong Mao. Author, maintainer.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mao J (2025). PhiSpace: Analysing compelx phenotypes bulk, single-cell spatial omics data. R package version 1.0.0.9000, https://jiadongm.github.io/PhiSpace/.","code":"@Manual{,   title = {PhiSpace: Analysing compelx phenotypes of bulk, single-cell and spatial omics data},   author = {Jiadong Mao},   year = {2025},   note = {R package version 1.0.0.9000},   url = {https://jiadongm.github.io/PhiSpace/}, }"},{"path":[]},{"path":"https://jiadongm.github.io/PhiSpace/index.html","id":"news","dir":"","previous_headings":"","what":"News","title":"Analysing compelx phenotypes of bulk, single-cell and spatial omics data","text":"[10 Feb 2025] PhiSpace ST paper bioRxiv. [12 Dec 2024] Added support SpatialExperiment input. [1 Nov 2024] Version 1.0.0.9000 released. -development version towards Φ-Space ST, unified approach spatial transcriptomics (ST) data analysis. New manuscript vignettes coming soon!","code":""},{"path":"https://jiadongm.github.io/PhiSpace/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Analysing compelx phenotypes of bulk, single-cell and spatial omics data","text":"Installing BioConductor dependencies: Install GitHub version PhiSpace:","code":"if(!requireNamespace(\"BiocManager\", quietly = TRUE)) {   install.packages(\"BiocManager\") } BiocManager::install(c(\"SingleCellExperiment\", \"scran\", \"scuttle\", \"ComplexHeatmap\", \"SpatialExperiment\")) if(!requireNamespace(\"devtools\", quietly = TRUE)) {   install.packages(\"devtools\") } devtools::install_github('jiadongm/PhiSpace/pkg')"},{"path":"https://jiadongm.github.io/PhiSpace/index.html","id":"what-is-φ-space","dir":"","previous_headings":"","what":"What is Φ-Space?","title":"Analysing compelx phenotypes of bulk, single-cell and spatial omics data","text":"Φ-Space computational framework reference-based continuous annotation cell states single-cell spatial multiomics data. Currently two modules: PhiSpace multiomics single-cell multiomics data (Mao et al., 2024, PhiSpace ST spatial transcriptomics data Mao et al., 2025) Given bulk single-cell RNA-seq reference dataset potentially multiple layers phenotypes defined metadata (e.g. cell type sample source), Φ-Space can phenotype continuum cells cell-like objects query dataset. core Φ-Space continuous phenotyping based partial least squares (PLS) regression. Compared conventional cell type annotation methods, Φ-Space following strengthss Identifying continuous --reference cell states; Robust batch effects; Utilising bulk multiomic refereneces queries; suitable exploring spatial patterns rare cell types. applied Φ-Space many different use cases, including","code":""},{"path":"https://jiadongm.github.io/PhiSpace/index.html","id":"cite-phispace","dir":"","previous_headings":"","what":"Cite PhiSpace","title":"Analysing compelx phenotypes of bulk, single-cell and spatial omics data","text":"Mao, Jiadong, Choi, Jarny Lê Cao, Kim-Anh. (2025). Φ-Space ST: platform-agnostic method identify cell states spatial transcriptomics studies. bioRxiv. Mao, Jiadong, Deng, Yidi Lê Cao, Kim-Anh. (2024). Φ-Space: Continuous phenotyping single-cell multi-omics data. bioRxiv. Check talk PhiSpace single-cell multiomics mixOmics website.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CLRnorm.html","id":null,"dir":"Reference","previous_headings":"","what":"Center log ratio normalisation — CLRnorm","title":"Center log ratio normalisation — CLRnorm","text":"Center log ratio normalisation","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CLRnorm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Center log ratio normalisation — CLRnorm","text":"","code":"CLRnorm(sce, assayName = \"counts\", targetAssay = \"data\", offset = 1)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/CLRnorm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Center log ratio normalisation — CLRnorm","text":"sce SCE object assayName Assay normalise targetAssay Name normalised assay offset Offset value added raw counts","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CLRnorm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Center log ratio normalisation — CLRnorm","text":"SCE object","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CVTune_ncomp.html","id":null,"dir":"Reference","previous_headings":"","what":"Tune ncomp using cross-validation. — CVTune_ncomp","title":"Tune ncomp using cross-validation. — CVTune_ncomp","text":"Tune ncomp using cross-validation.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CVTune_ncomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tune ncomp using cross-validation. — CVTune_ncomp","text":"","code":"CVTune_ncomp(   reference,   assayName = \"logcounts\",   phenotypes = NULL,   YY = NULL,   center = TRUE,   scale = FALSE,   ncompLimits = c(1, 100),   gridSize = 20,   ncompGrid = NULL,   selectedFeat = NULL,   Kfolds = 5,   regMethod = \"PCA\",   labelCode = \"-1,1\",   Ncores = 1,   seed = 5202056 )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/CVTune_ncomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tune ncomp using cross-validation. — CVTune_ncomp","text":"reference SingleCellExperiment object. assayName Character. phenotypes Character. YY Matrix. center Logic. scale Logic. ncompLimits Vector. gridSize Integer. ncompGrid Vector. selectedFeat Vector. Kfolds Integer. regMethod Character. labelCode Character. Ncores Integer. seed Integer.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CVTune_ncomp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tune ncomp using cross-validation. — CVTune_ncomp","text":"list.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CVTune_nfeat.html","id":null,"dir":"Reference","previous_headings":"","what":"Tune nfeat using cross-validation. — CVTune_nfeat","title":"Tune nfeat using cross-validation. — CVTune_nfeat","text":"Tune nfeat using cross-validation.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CVTune_nfeat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tune nfeat using cross-validation. — CVTune_nfeat","text":"","code":"CVTune_nfeat(   reference,   assayName = \"logcounts\",   phenotypes = NULL,   YY = NULL,   ncomp = NULL,   impScores = NULL,   center = TRUE,   scale = FALSE,   nfeatLimits = c(10, 15000),   gridSize = 30,   nfeatV = NULL,   Kfolds = 5,   regMethod = \"PCA\",   labelCode = \"-1,1\",   seed = 5202056,   Ncores = 1 )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/CVTune_nfeat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tune nfeat using cross-validation. — CVTune_nfeat","text":"reference SingleCellExperiment object. assayName Character. phenotypes Vector. YY Matrix. ncomp Integer. impScores Matrix. center Logic. scale Logic. nfeatLimits Vector. gridSize Integer. nfeatV Vector. Kfolds Integer. regMethod Character. labelCode Character. seed Integer. Ncores Integer.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/CVTune_nfeat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tune nfeat using cross-validation. — CVTune_nfeat","text":"list.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/KeepCommonGenes.html","id":null,"dir":"Reference","previous_headings":"","what":"Keep common genes of two SingleCellExperiment objects. — KeepCommonGenes","title":"Keep common genes of two SingleCellExperiment objects. — KeepCommonGenes","text":"Keep common genes two SingleCellExperiment objects.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/KeepCommonGenes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Keep common genes of two SingleCellExperiment objects. — KeepCommonGenes","text":"","code":"KeepCommonGenes(reference, query, dots2hyphen = F)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/KeepCommonGenes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Keep common genes of two SingleCellExperiment objects. — KeepCommonGenes","text":"reference SingleCellExperiment object. query SingleCellExperiment object. dots2hyphen Logic.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/KeepCommonGenes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Keep common genes of two SingleCellExperiment objects. — KeepCommonGenes","text":"list containing updated SingleCellExperiment obejcts matching features.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpace-package.html","id":null,"dir":"Reference","previous_headings":"","what":"PhiSpace: Analysing compelx phenotypes of bulk, single-cell and spatial omics data — PhiSpace-package","title":"PhiSpace: Analysing compelx phenotypes of bulk, single-cell and spatial omics data — PhiSpace-package","text":"Continous phenotyping bulk, single-cell spatial omics data using partial least squares regression.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpace-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"PhiSpace: Analysing compelx phenotypes of bulk, single-cell and spatial omics data — PhiSpace-package","text":"Maintainer: Jiadong Mao chiatungmao@gmail.com (ORCID)","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpace.html","id":null,"dir":"Reference","previous_headings":"","what":"PhiSpace continuous phenotyping — PhiSpace","title":"PhiSpace continuous phenotyping — PhiSpace","text":"PhiSpace annotates query dataset list query datasets, given annotated bulk single-cell RNA-seq references. PhiSpace can simultaneously model multiple layers cell phenotypes, e.g. cell type disease condtion.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpace.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PhiSpace continuous phenotyping — PhiSpace","text":"","code":"PhiSpace(   reference,   query,   phenotypes = NULL,   response = NULL,   PhiSpaceAssay = \"rank\",   regMethod = c(\"PLS\", \"PCA\"),   ncomp = NULL,   nfeat = NULL,   selectedFeat = NULL,   center = TRUE,   scale = FALSE,   DRinfo = FALSE,   storeUnNorm = FALSE,   updateRef = FALSE,   assay2rank = NULL )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpace.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PhiSpace continuous phenotyping — PhiSpace","text":"reference references. SingleCellExperiment (SCE) object list SCE objects. must contain assay named PhiSpaceAssay. query queries. SCE object list SCE object. must contain assay named PhiSpaceAssay. phenotypes phenotypes (e.g. \"cell type\") predict. NULL, specify response. response Named matrix. Rows correpond cells (columns) reference; columns correspond phenotypes. NULL, override phenotypes. PhiSpaceAssay Character. assay use train. regMethod Character. Regression method: one \"PLS\" \"PCA\". ncomp Integer. Number components. NULL, use default, .e. total number phenotypes. nfeat Integer. Number features choose predict phenotype. See details. selectedFeat Character. Alternatively, can provide vector pre-selected features. center Logic. Whether perform centering. See details. scale Logic. Whether perform scaling. See details. DRinfo Logic. Whether return dimension reduction information PCA PLS. default disabled save memory. storeUnNorm Store unnormalised raw PhiSpace scores . Default FALSE. updateRef Update reference (store reference PhiSpace scores reference sce object) . assay2rank assay used rank transform. specified, \"rank\" used.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpace.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PhiSpace continuous phenotyping — PhiSpace","text":"updateRef = FALSE (default): updated query SCE object PhiSpace annotation results stored reducedDim slot \"PhiSpace\"; updateRef = TRUE: list updated reference query SCE objects PhiSpace annotation results stored reducedDim slot \"PhiSpace\".","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpace.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"PhiSpace continuous phenotyping — PhiSpace","text":"Parameter tuning default, PhiSpace takes ncomp equal total number phenotypes. example, 20 cell types 5 sample sources (e.g. vivo vitro) defined reference, ncomp set 25. default, PhiSpace feature selection. However, feature selection straightforward PhiSpace. partial least squares model automatically rank features according contribution predicting phenotype. example, 25 phenotypes PLS return 25 rankings features. Based , customised feature selection can done two ways. user either specify nfeat, .e. number features (markers) used predict phenotype; specify selectedFeat, .e. subset features used predict phenotypes (e.g. highly variable genes). nfeat provided, selectedFeat automatically defined union nfeat markers phenotypes. Center scale default, PhiSpace center data scale. often use features standard single-cell pipelines (e.g. Seurat selects 2,000 highly variable genes) better prediction. means might included genes small variance scaling greatly inflate expression levels genes.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpace.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"PhiSpace continuous phenotyping — PhiSpace","text":"Mao J., Deng, Y. Lê Cao, K.-. (2024).Φ-Space: Continuous phenotyping single-cell multi-omics data. bioRxiv.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpaceR_1ref.html","id":null,"dir":"Reference","previous_headings":"","what":"PhiSpace using a single reference — PhiSpaceR_1ref","title":"PhiSpace using a single reference — PhiSpaceR_1ref","text":"PhiSpace using single reference","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpaceR_1ref.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PhiSpace using a single reference — PhiSpaceR_1ref","text":"","code":"PhiSpaceR_1ref(   reference,   query,   phenotypes = NULL,   response = NULL,   PhiSpaceAssay = \"rank\",   regMethod = c(\"PLS\", \"PCA\"),   ncomp = NULL,   nfeat = NULL,   selectedFeat = NULL,   center = TRUE,   scale = FALSE,   DRinfo = FALSE,   assay2rank = NULL )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpaceR_1ref.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PhiSpace using a single reference — PhiSpaceR_1ref","text":"reference SCE. reference. query SCE list SCE. query. phenotypes Charater. types phenotypes predict. NULL, specify response. Currently support categorical phenotypes. continuous ones, specify response directly. response Named matrix. Rows correspond cells (columns) reference; columns correspond phenotypes. NULL, override phenotypes. Can continuous values age BMI. PhiSpaceAssay Character. assay use train regMethod Character. Regression method: one PLS PCA ncomp Integer. nfeat Integer. selectedFeat Character. center Logic. scale Logic. DRinfo Logic. Whether return dimension reduction information PCA PLS. Disable save memory. assay2rank assay used rank transform. specified, \"rank\" used.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/PhiSpaceR_1ref.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PhiSpace using a single reference — PhiSpaceR_1ref","text":"list","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/RTassay.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply rank transform to a gene by cell matrix. — RTassay","title":"Apply rank transform to a gene by cell matrix. — RTassay","text":"Apply rank transform gene cell matrix.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/RTassay.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply rank transform to a gene by cell matrix. — RTassay","text":"","code":"RTassay(X)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/RTassay.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply rank transform to a gene by cell matrix. — RTassay","text":"X gene cell matrix.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/RTassay.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply rank transform to a gene by cell matrix. — RTassay","text":"Rank transformed cell gene matrix.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/RankTransf.html","id":null,"dir":"Reference","previous_headings":"","what":"Rank transform of a SingleCellExperiment object. — RankTransf","title":"Rank transform of a SingleCellExperiment object. — RankTransf","text":"Rank transform SingleCellExperiment object.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/RankTransf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rank transform of a SingleCellExperiment object. — RankTransf","text":"","code":"RankTransf(sce, assayname = \"counts\", targetAssay = \"rank\", sparse = TRUE)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/RankTransf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rank transform of a SingleCellExperiment object. — RankTransf","text":"sce SingleCellExperiment object. assayname Character. targetAssay Character. sparse Logic.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/RankTransf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rank transform of a SingleCellExperiment object. — RankTransf","text":"updated SingleCellExperiment object rank transformed assay.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/SuperPC.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute regression model using selected features. — SuperPC","title":"Compute regression model using selected features. — SuperPC","text":"Compute regression model using selected features.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/SuperPC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute regression model using selected features. — SuperPC","text":"","code":"SuperPC(   reference,   YY,   ncomp,   selectedFeat = NULL,   assayName = \"logcounts\",   regMethod = c(\"PCA\", \"PLS\"),   center = TRUE,   scale = FALSE,   sparse = TRUE,   DRinfo = FALSE )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/SuperPC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute regression model using selected features. — SuperPC","text":"reference SingleCellExperiment object. reference YY Resonse matrix ncomp Integer. Number components selectedFeat Character. Vector containing selected feature names assayName assay reference use prediction regMethod Character. Regression method use, either PCA PLS. center Logic. scale Logic. Scale predictor matrix sparse Use sparse matrices . DRinfo Logic. Whether return dimension reduction information PCA PLS. Disable save memory.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/SuperPC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute regression model using selected features. — SuperPC","text":"list containing regression input output.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/VizSpatial.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualising features (eg gene expression), metadata (eg cell type) or reducedDim component (eg PhiSpace cell type score) in 2D tissue space. — VizSpatial","title":"Visualising features (eg gene expression), metadata (eg cell type) or reducedDim component (eg PhiSpace cell type score) in 2D tissue space. — VizSpatial","text":"2D spatial coordinates (x y) stored two columns colData.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/VizSpatial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualising features (eg gene expression), metadata (eg cell type) or reducedDim component (eg PhiSpace cell type score) in 2D tissue space. — VizSpatial","text":"","code":"VizSpatial(   obj,   x_coord = \"x\",   y_coord = \"y\",   ptSize = 2,   ptShape = 16,   groupBy = NULL,   feature = NULL,   assay2use = NULL,   reducedDim = NULL,   reducedDim2use = \"PhiSpace\",   censor = FALSE,   quant = 0.5,   legend.position = \"right\",   legend.symb.size = NULL,   legend.title = NULL,   fsize = 14,   reOrder = F,   ... )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/VizSpatial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualising features (eg gene expression), metadata (eg cell type) or reducedDim component (eg PhiSpace cell type score) in 2D tissue space. — VizSpatial","text":"obj Input object; either SingleCellExperiemnt SpatialExperiment. SingleCellExperiemnt, colData(obj) contain columns named x_coord y_coord . x_coord x coordinate name column colData (type(ojb) == SingleCellExperiemnt). y_coord y coordinate name column colData (type(ojb) == SingleCellExperiemnt). ptSize Size point, representing spatial cell like objects (segmented cells, spots etc). ptShape Shape point. groupBy Name metadata column colour points . feature Name feature (eg gene) colour points . assay2use assay use feature specified. reducedDim Name reducedDim column colour points . reducedDim2use Name reducedDim layer use reducedDim specified. censor Logical. Whether set smaller colour values zero. Default FALSE. (Recommend set TRUE visualise PhiSpace scores,) quant value 0 1. Colour values quant set zero censor=TRUE. legend.position Position legened, one \"right\", \"bottome\", \"left\" \"top\". legend.symb.size Legend symbol size (discrete legend). legend.title Alternative legend name replace original. fsize Base font size figure. reOrder Logical. Whether reorder points according values (ascending) . Set TRUE avoid overplotting. ... arguments pass basicPlotFormat.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/VizSpatial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualising features (eg gene expression), metadata (eg cell type) or reducedDim component (eg PhiSpace cell type score) in 2D tissue space. — VizSpatial","text":"ggplot2 object.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/align_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Align clustering results. — align_clusters","title":"Align clustering results. — align_clusters","text":"Given reference clustering result, represented vector cluster labels, align query clustering result reference one.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/align_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Align clustering results. — align_clusters","text":"","code":"align_clusters(clust, clust_ref)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/align_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Align clustering results. — align_clusters","text":"clust Query clustering result, can numerical, character factor vector. clust_ref Reference clustering result.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/align_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Align clustering results. — align_clusters","text":"Re-aligned clustering result, represented factor vector.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/as.sparse.matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a matrix to sparse metrix. — as.sparse.matrix","title":"Convert a matrix to sparse metrix. — as.sparse.matrix","text":"Convert matrix sparse metrix.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/as.sparse.matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a matrix to sparse metrix. — as.sparse.matrix","text":"","code":"as.sparse.matrix(X)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/as.sparse.matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a matrix to sparse metrix. — as.sparse.matrix","text":"X Matrix.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/as.sparse.matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a matrix to sparse metrix. — as.sparse.matrix","text":"Sparse matrix version X","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/basicPlotFormat.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot formatting for presentation and publication — basicPlotFormat","title":"Plot formatting for presentation and publication — basicPlotFormat","text":"Plot formatting presentation publication","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/basicPlotFormat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot formatting for presentation and publication — basicPlotFormat","text":"","code":"basicPlotFormat(   p,   theme_overall = \"bw\",   base_size = 8,   legend.position = \"top\",   x.text.blank = F,   y.text.blank = F,   axis.title.bold = T,   legend.title.bold = T,   axis.title.x.blank = F,   axis.title.y.blank = F,   legend.title.blank = F,   legend.spacing.x = 0,   legend.key.spacing = 0,   legend.key.spacing.y = 0,   legend.box.margin = 0,   legend.box.spacing = 0,   legend.key.size = 8 )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/basicPlotFormat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot formatting for presentation and publication — basicPlotFormat","text":"p ggplot2 object. theme_overall Theme p. base_size base_size theme. legend.position Legend position. x.text.blank Logical. Set x axis text blank. y.text.blank Logical. Set y axis text blank. axis.title.bold Logical. Set title bold. legend.title.bold Logical. Set legend title bold. axis.title.x.blank Logical. Set x axis title bold. axis.title.y.blank Logical. Set y axis title bold. legend.title.blank Logical. Set legend title blank. legend.spacing.x Legend spacing. legend.key.spacing Legend key spacing. legend.key.spacing.y Legend key spacing vertical direction. legend.box.margin Legend box margin. legend.box.spacing Legend box spacing., legend.key.size Legend key size.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/basicPlotFormat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot formatting for presentation and publication — basicPlotFormat","text":"ggplot2 object.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/cellTypeCorMat.html","id":null,"dir":"Reference","previous_headings":"","what":"Create cell type correlation matrices — cellTypeCorMat","title":"Create cell type correlation matrices — cellTypeCorMat","text":"generic function compute correlation matrix different input types, including matrix, data.frame SingleCellExperiment objects.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/cellTypeCorMat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create cell type correlation matrices — cellTypeCorMat","text":"","code":"cellTypeCorMat(input, mask = NULL, reducedDimName = \"PhiSpace\", groupBy = NULL)  # S4 method for class 'matrix' cellTypeCorMat(input, mask = NULL, reducedDimName = \"PhiSpace\", groupBy = NULL)  # S4 method for class 'data.frame' cellTypeCorMat(input, mask = NULL, reducedDimName = \"PhiSpace\", groupBy = NULL)  # S4 method for class 'SingleCellExperiment' cellTypeCorMat(input, mask = NULL, reducedDimName = \"PhiSpace\", groupBy = NULL)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/cellTypeCorMat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create cell type correlation matrices — cellTypeCorMat","text":"input matrix containing numeric data correlation computation. mask zero-one matrix number rows input. Optional. provided, column mask defines subset rows used compute separate correlation matrix. reducedDimName character string specifying name reduced dimension use SingleCellExperiment objects. Defaults \"PhiSpace\". groupBy column colData(input) input SCE object. provided, mask defined according colData(input)[,groupBy].","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/cellTypeCorMat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create cell type correlation matrices — cellTypeCorMat","text":"mask provided, returns list correlation matrices (one per column mask). Otherwise, returns single correlation matrix.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/cellTypeCorMat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create cell type correlation matrices — cellTypeCorMat","text":"method calculates correlation matrix directly input matrix. method first converts data.frame matrix calculates correlation matrix. method uses reduced dimension \"PhiSpace\" SingleCellExperiment object compute correlation matrix. \"PhiSpace\" available, error raised.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/classErr.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate classification errors. — classErr","title":"Calculate classification errors. — classErr","text":"Calculate classification errors. Calcualte classification errors.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/classErr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate classification errors. — classErr","text":"","code":"classErr(classQuery, classOriginal, labPerSample = NULL)  classErr(classQuery, classOriginal, labPerSample = NULL)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/classErr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate classification errors. — classErr","text":"classQuery Character vector. classOriginal Character vector. labPerSample Integer.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/classErr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate classification errors. — classErr","text":"list. list containing: err  byClassErrs","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/codeY.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert discrete annotations to dummy variable matrices. — codeY","title":"Convert discrete annotations to dummy variable matrices. — codeY","text":"Convert discrete annotations dummy variable matrices.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/codeY.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert discrete annotations to dummy variable matrices. — codeY","text":"","code":"codeY(sce, phenotypes, method = c(\"-1,1\", \"0,1\"))"},{"path":"https://jiadongm.github.io/PhiSpace/reference/codeY.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert discrete annotations to dummy variable matrices. — codeY","text":"sce SingleCellExperiment object. phenotypes phenotype annotations (e.g. cell types) convert. method coding use, either (-1,1) (0,1).","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/codeY.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert discrete annotations to dummy variable matrices. — codeY","text":"YY dummy variable matrix encoding discrete annotation","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/codeY_vec.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert discrete annotations to dummy variable matrices. — codeY_vec","title":"Convert discrete annotations to dummy variable matrices. — codeY_vec","text":"Convert discrete annotations dummy variable matrices.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/codeY_vec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert discrete annotations to dummy variable matrices. — codeY_vec","text":"","code":"codeY_vec(vec, rowNames = NULL, method = c(\"-1,1\", \"0,1\"))"},{"path":"https://jiadongm.github.io/PhiSpace/reference/codeY_vec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert discrete annotations to dummy variable matrices. — codeY_vec","text":"vec Factor contanining class labels. rowNames Optional. Row names output dummy matrix (eg cell barcode). method coding use, either (-1,1) (0,1).","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/codeY_vec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert discrete annotations to dummy variable matrices. — codeY_vec","text":"YY dummy variable matrix encoding discrete annotation","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/computUMAP.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute UMAP. — computUMAP","title":"Compute UMAP. — computUMAP","text":"Compute UMAP.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/computUMAP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute UMAP. — computUMAP","text":"","code":"computUMAP(   dat,   computPC = TRUE,   ncomp = 30,   center = TRUE,   scale = FALSE,   config = NULL )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/computUMAP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute UMAP. — computUMAP","text":"dat Input data. computPC Whether compute PC first. ncomp Number PC components center Center . scale Scale . config Configuration UMAP (see umap package).","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/computUMAP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute UMAP. — computUMAP","text":"UMAP coordinates.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/doubleCent.html","id":null,"dir":"Reference","previous_headings":"","what":"Double center a matrix by column and row means, resulting in a new matrix with zero row and column means. — doubleCent","title":"Double center a matrix by column and row means, resulting in a new matrix with zero row and column means. — doubleCent","text":"Double center matrix column row means, resulting new matrix zero row column means.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/doubleCent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Double center a matrix by column and row means, resulting in a new matrix with zero row and column means. — doubleCent","text":"","code":"doubleCent(X)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/doubleCent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Double center a matrix by column and row means, resulting in a new matrix with zero row and column means. — doubleCent","text":"X matrix object convertible one.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/doubleCent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Double center a matrix by column and row means, resulting in a new matrix with zero row and column means. — doubleCent","text":"double-centred matrix.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getClass.html","id":null,"dir":"Reference","previous_headings":"","what":"Dicretise soft annotation to labels. — getClass","title":"Dicretise soft annotation to labels. — getClass","text":"Dicretise soft annotation labels.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getClass.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dicretise soft annotation to labels. — getClass","text":"","code":"getClass(X, labPerSample = NULL)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/getClass.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dicretise soft annotation to labels. — getClass","text":"X Matrix. labPerSample Integer.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getClass.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dicretise soft annotation to labels. — getClass","text":"vector contaning labels.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getErr.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute different errors for cross-validation. — getErr","title":"Compute different errors for cross-validation. — getErr","text":"Compute different errors cross-validation.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getErr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute different errors for cross-validation. — getErr","text":"","code":"getErr(   ncompGrid,   XXtrain,   YYtrain,   XXtest,   YYtest,   center = TRUE,   scale = FALSE,   selectedFeat = NULL,   regMethod = \"PLS\",   assayName = \"rank\",   loss = c(\"Frobenius\", \"exponential\") )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/getErr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute different errors for cross-validation. — getErr","text":"ncompGrid Vector. XXtrain Matrix. YYtrain Matrix. XXtest Matrix. YYtest Matrix. center Logic. scale Logic. selectedFeat Vector. regMethod Character. assayName Character. loss Type loss function.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getErr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute different errors for cross-validation. — getErr","text":"list","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getErr_nfeat.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate errors for the cross-validation for selecting nfeat. — getErr_nfeat","title":"Calculate errors for the cross-validation for selecting nfeat. — getErr_nfeat","text":"Calculate errors cross-validation selecting nfeat.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getErr_nfeat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate errors for the cross-validation for selecting nfeat. — getErr_nfeat","text":"","code":"getErr_nfeat(   nfeatV,   impScores,   ncomp,   XXtrain,   YYtrain,   XXtest,   YYtest,   center = TRUE,   scale = FALSE,   regMethod = \"PLS\",   assayName = \"logcounts\",   loss = c(\"Frobenius\", \"exponential\") )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/getErr_nfeat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate errors for the cross-validation for selecting nfeat. — getErr_nfeat","text":"nfeatV Vector. impScores Matrix. ncomp Integer. XXtrain Matrix. YYtrain Matrix. XXtest Matrix. YYtest Matrix. center Logic. scale Logic. regMethod Character. assayName Character. loss Type loss function.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getErr_nfeat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate errors for the cross-validation for selecting nfeat. — getErr_nfeat","text":"list.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getPC.html","id":null,"dir":"Reference","previous_headings":"","what":"Principal component analysis (PCA) based on partial singular value decomposition (SVD). — getPC","title":"Principal component analysis (PCA) based on partial singular value decomposition (SVD). — getPC","text":"Principal component analysis (PCA) based partial singular value decomposition (SVD).","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getPC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Principal component analysis (PCA) based on partial singular value decomposition (SVD). — getPC","text":"","code":"getPC(X, ncomp, center = TRUE, scale = FALSE, sparse = FALSE)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/getPC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Principal component analysis (PCA) based on partial singular value decomposition (SVD). — getPC","text":"X Matrix. ncomp Integer. center Logic. scale Logic. sparse Use sparse matrix .","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/getPC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Principal component analysis (PCA) based on partial singular value decomposition (SVD). — getPC","text":"list containing scores Score matrix X. loadings Laoding matrix X. sdev  totVar  props  accuProps  ncomp  selectFeat  reg_re","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/loadBarplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot loadings of dimension reduction as bar plot. — loadBarplot","title":"Plot loadings of dimension reduction as bar plot. — loadBarplot","text":"Plot loadings dimension reduction bar plot.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/loadBarplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot loadings of dimension reduction as bar plot. — loadBarplot","text":"","code":"loadBarplot(   Loadings,   comp = \"comp1\",   showInt = F,   absVal = T,   showNeg = F,   nfeat = 30,   fsize = 14,   xlab = \"\" )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/loadBarplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot loadings of dimension reduction as bar plot. — loadBarplot","text":"Loadings data.frame object (eg matrix) convertable data.frame: columns components rows features. comp Character. component plot. showInt Logical. Weather show cell type interaction (eg PhiSpace ST cell type co-presence analysis). absVal Logical. Rank loadings absolute values . showNeg Logical. Show negative loadings . nfeat Number top loadings show. fsize Font size. xlab x axis title.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/loadBarplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot loadings of dimension reduction as bar plot. — loadBarplot","text":"ggplot2 object.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/logTransf.html","id":null,"dir":"Reference","previous_headings":"","what":"Relative counts normalisation. — logTransf","title":"Relative counts normalisation. — logTransf","text":"Relative counts normalisation.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/logTransf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Relative counts normalisation. — logTransf","text":"","code":"logTransf(   sce,   scalFactor = 10000,   assayName = \"counts\",   targetAssay = \"data\",   use_log1p = FALSE,   sparse = TRUE )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/logTransf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Relative counts normalisation. — logTransf","text":"sce SingleCellExperiment object. scalFactor Scale factor inflate relative counts. assayName Character. targetAssay Character. use_log1p Logical. Use shifted log (log1p) transform, using raw counts instead relative counts. sparse Store transformed assay sparse matrix .","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/logTransf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Relative counts normalisation. — logTransf","text":"SingleCellExperiment object containing new assay relative counts normalisation.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/matrixPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Score matrix plot — matrixPlot","title":"Score matrix plot — matrixPlot","text":"Density pairwise scatter plots visualising score matrices.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/matrixPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Score matrix plot — matrixPlot","text":"","code":"matrixPlot(   scores,   max_ncomp = NULL,   comp_idx = NULL,   colBy = NULL,   pointAlpha = NULL,   pointSize = 1,   manualCol = NULL,   manualAlpha = NULL,   fsize = 14,   returnPlotList = F,   legendTitle = \"\",   compName = \"comp\" )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/matrixPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Score matrix plot — matrixPlot","text":"scores Matrix scores plotted max_ncomp Default NULL. Number first components plot. specified, override comp_idx. comp_idx Default NULL. Indices components plot. colBy Numeric charactor vectors specify colour points. pointAlpha Alpha value. pointSize Point size. manualCol Manual specification colours. manualAlpha Manual specification alpha colours. fsize Figure font size. returnPlotList Logical. Whether return individual plots. legendTitle Legend title. compName Name components, default \"comp\", 1st column named comp1 etc.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/mvr.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate regression via principal component analysis (PCA) or partial least squares (PLS). — mvr","title":"Multivariate regression via principal component analysis (PCA) or partial least squares (PLS). — mvr","text":"Simplified version pls::mvr, using computationally faster versions PCA PLS.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/mvr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate regression via principal component analysis (PCA) or partial least squares (PLS). — mvr","text":"","code":"mvr(   X,   Y,   ncomp,   method = c(\"PCA\", \"PLS\"),   center = TRUE,   sparse = FALSE,   scale = FALSE,   DRinfo = FALSE )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/mvr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate regression via principal component analysis (PCA) or partial least squares (PLS). — mvr","text":"X Matrix. Y Matrix. ncomp Integer. method Character. center Logic. sparse Convert X sparse matrix . scale Logic. DRinfo Logic. Whether return dimension reduction information PCA PLS. Disable save memory.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/mvr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate regression via principal component analysis (PCA) or partial least squares (PLS). — mvr","text":"list containing coefficients Regression coefficient matrices. Xmeans  Ymeans  ncomp  method","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/normPhiScores.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalise PhiSpace phenotypic scores by row or by column. — normPhiScores","title":"Normalise PhiSpace phenotypic scores by row or by column. — normPhiScores","text":"-row normalisation SingleR:::.trim_byLabel_and_normalize_scores.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/normPhiScores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalise PhiSpace phenotypic scores by row or by column. — normPhiScores","text":"","code":"normPhiScores(X, method = c(\"col\", \"row\"))"},{"path":"https://jiadongm.github.io/PhiSpace/reference/normPhiScores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalise PhiSpace phenotypic scores by row or by column. — normPhiScores","text":"X Matrix. method Character.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/normPhiScores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalise PhiSpace phenotypic scores by row or by column. — normPhiScores","text":"matrix normalised row column.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/phenotype.html","id":null,"dir":"Reference","previous_headings":"","what":"Soft phenotyping of query assay. — phenotype","title":"Soft phenotyping of query assay. — phenotype","text":"Soft phenotyping query assay.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/phenotype.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Soft phenotyping of query assay. — phenotype","text":"","code":"phenotype(   phenoAssay,   atlas_re,   assayName = \"rank\",   scaleMethod = c(\"byQuery\", \"byRef\") )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/phenotype.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Soft phenotyping of query assay. — phenotype","text":"phenoAssay Matrix. Query assay phenotype. atlas_re List. assayName Character. scaleMethod Character.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/phenotype.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Soft phenotyping of query assay. — phenotype","text":"list containing Yhat  Proj","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotPhiSpaceHeatMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot PhiSpace scores as a heatmap — plotPhiSpaceHeatMap","title":"Plot PhiSpace scores as a heatmap — plotPhiSpaceHeatMap","text":"Plot PhiSpace scores heatmap","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotPhiSpaceHeatMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot PhiSpace scores as a heatmap — plotPhiSpaceHeatMap","text":"","code":"plotPhiSpaceHeatMap(   PhiSpaceScore,   reference,   phenotypes,   queryLabs = NULL,   refLvls = NULL,   queryLvls = NULL,   cluster_columns = FALSE,   cluster_rows = FALSE,   show_row_names = FALSE,   show_column_names = TRUE,   ... )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotPhiSpaceHeatMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot PhiSpace scores as a heatmap — plotPhiSpaceHeatMap","text":"PhiSpaceScore Matrix. reference SingleCellExperiment object. phenotypes Character vector. queryLabs Character vector. refLvls Character vector. queryLvls Character vector. cluster_columns Logic. cluster_rows Logic. show_row_names Logic. show_column_names Logic. ... Additional parameters adjusting ComplexHeatmap object","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotPhiSpaceHeatMap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot PhiSpace scores as a heatmap — plotPhiSpaceHeatMap","text":"heatmap PhiSpace scores.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotSankey.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Sankey diagram for two classification results. — plotSankey","title":"Plot Sankey diagram for two classification results. — plotSankey","text":"Plot Sankey diagram two classification results.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotSankey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Sankey diagram for two classification results. — plotSankey","text":"","code":"plotSankey(class1, class2, fontsize = 12)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotSankey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Sankey diagram for two classification results. — plotSankey","text":"class1 Vector. class2 Vector. fontsize Numeric.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotSankey3.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Sankey diagram for three hard classification results. — plotSankey3","title":"Plot Sankey diagram for three hard classification results. — plotSankey3","text":"Plot Sankey diagram three hard classification results.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotSankey3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Sankey diagram for three hard classification results. — plotSankey3","text":"","code":"plotSankey3(class1, class2, class3, add = TRUE, fontsize = 12)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/plotSankey3.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Sankey diagram for three hard classification results. — plotSankey3","text":"class1 Vector. class2 Vector. class3 Vector. add Logic. fontsize Numeric.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/pseudoBulk.html","id":null,"dir":"Reference","previous_headings":"","what":"Converting single cells to pseudo-bulks. — pseudoBulk","title":"Converting single cells to pseudo-bulks. — pseudoBulk","text":"Converting single cells pseudo-bulks.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/pseudoBulk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Converting single cells to pseudo-bulks. — pseudoBulk","text":"","code":"pseudoBulk(   sce,   phenotypes = NULL,   response = NULL,   clusterid = NULL,   assayName = \"counts\",   resampSizes = 100,   proportion = NULL,   calcMean = FALSE,   nPool = 15,   seed = 904800 )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/pseudoBulk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Converting single cells to pseudo-bulks. — pseudoBulk","text":"sce SingleCellExpeirment object. phenotypes Phenotypes predict. Can multiple. response Response matrix. Can continuous. clusterid Column name colData specifying groups pseudobulking. assayName Assay used pseudobulking. resampSizes many pseudo-bulk resamples generate cluster. proportion Used determine unequal resampSizes. calcMean Logical. Calculate mean sum expression pseudobulking. nPool many cells use pseudobulking. seed Random seeds","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/pseudoBulk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Converting single cells to pseudo-bulks. — pseudoBulk","text":"updated SingleCellExpeirment object pseudobulk assay.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/reNameCols.html","id":null,"dir":"Reference","previous_headings":"","what":"Turn a matrix to a data.frame withe newly defined colnames. — reNameCols","title":"Turn a matrix to a data.frame withe newly defined colnames. — reNameCols","text":"Turn matrix data.frame withe newly defined colnames.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/reNameCols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Turn a matrix to a data.frame withe newly defined colnames. — reNameCols","text":"","code":"reNameCols(mat, key = \"comp\")"},{"path":"https://jiadongm.github.io/PhiSpace/reference/reNameCols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Turn a matrix to a data.frame withe newly defined colnames. — reNameCols","text":"mat Matrix. key String.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/reNameCols.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Turn a matrix to a data.frame withe newly defined colnames. — reNameCols","text":"Data frame.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/scranTransf.html","id":null,"dir":"Reference","previous_headings":"","what":"Run scran normalisation — scranTransf","title":"Run scran normalisation — scranTransf","text":"Run scran normalisation","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/scranTransf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run scran normalisation — scranTransf","text":"","code":"scranTransf(sce, assayName = \"counts\", clusts = NULL)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/scranTransf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run scran normalisation — scranTransf","text":"sce SCE object. assayName Assay name. clusts Cluster labels (optional).","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/scranTransf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run scran normalisation — scranTransf","text":"SCE object.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/selectFeat.html","id":null,"dir":"Reference","previous_headings":"","what":"Select nfeat top features from each column (label) of impScores — selectFeat","title":"Select nfeat top features from each column (label) of impScores — selectFeat","text":"Select nfeat top features column (label) impScores","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/selectFeat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select nfeat top features from each column (label) of impScores — selectFeat","text":"","code":"selectFeat(impScores, nfeat = 5, absVal = TRUE)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/selectFeat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select nfeat top features from each column (label) of impScores — selectFeat","text":"impScores Matrix. column corresponds phenotype (eg cell type) contains importance scores features predicting phenotype. nfeat Number top features select column impScores. absVal Take absolute value .","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/selectFeat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select nfeat top features from each column (label) of impScores — selectFeat","text":"Vector selected features.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/split2.html","id":null,"dir":"Reference","previous_headings":"","what":"Create partitions of data for cross-validation. — split2","title":"Create partitions of data for cross-validation. — split2","text":"Create partitions data cross-validation.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/split2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create partitions of data for cross-validation. — split2","text":"","code":"split2(x, n)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/split2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create partitions of data for cross-validation. — split2","text":"x Vector. n Integer.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/split2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create partitions of data for cross-validation. — split2","text":"partition index vector x n folds.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/subsample.html","id":null,"dir":"Reference","previous_headings":"","what":"Subsample from a sce object — subsample","title":"Subsample from a sce object — subsample","text":"Subsample sce object","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/subsample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subsample from a sce object — subsample","text":"","code":"subsample(sce, key = NULL, proportion = 0.1, minCellNum = 50, seed = 5202056)"},{"path":"https://jiadongm.github.io/PhiSpace/reference/subsample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subsample from a sce object — subsample","text":"sce SCE object sampled key Required stratefied subsampling proportion Proportion cells sample minCellNum Minimum number cells category seed Random seed","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/subsample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subsample from a sce object — subsample","text":"downsized SCE object","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/translateLabel.html","id":null,"dir":"Reference","previous_headings":"","what":"Translate cell type labels from finer to coarser according to a dictionary. — translateLabel","title":"Translate cell type labels from finer to coarser according to a dictionary. — translateLabel","text":"Translate cell type labels finer coarser according dictionary.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/translateLabel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Translate cell type labels from finer to coarser according to a dictionary. — translateLabel","text":"","code":"translateLabel(text, dictionary, dFrom = \"label.fine\", dTo = \"label.main\")"},{"path":"https://jiadongm.github.io/PhiSpace/reference/translateLabel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Translate cell type labels from finer to coarser according to a dictionary. — translateLabel","text":"text Character vector. dictionary Data frame. dFrom Character. dTo Character.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/translateLabel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Translate cell type labels from finer to coarser according to a dictionary. — translateLabel","text":"vector containing translated labels.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/tunePhiSpace.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — tunePhiSpace","title":"Title — tunePhiSpace","text":"Title","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/tunePhiSpace.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — tunePhiSpace","text":"","code":"tunePhiSpace(   reference,   assayName = \"logcounts\",   phenotypes = NULL,   YY = NULL,   ncomp = NULL,   impScores = NULL,   center = TRUE,   scale = FALSE,   tune_ncomp = TRUE,   tune_nfeat = TRUE,   ncompLimits = c(1, 100),   ncompGridSize = 20,   ncompGrid = NULL,   selectedFeat = NULL,   nfeatLimits = c(10, 15000),   nfeatGridSize = 30,   nfeatV = NULL,   Kfolds = 5,   regMethod = \"PLS\",   labelCode = \"-1,1\",   Ncores = 1,   seed = 5202056 )"},{"path":"https://jiadongm.github.io/PhiSpace/reference/tunePhiSpace.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — tunePhiSpace","text":"reference SingleCellExperiment object. assayName Character. phenotypes Character. YY Matrix. ncomp Integer. impScores Matrix. center Logical. scale Logical. tune_ncomp Logic. tune_nfeat Logic. ncompLimits Vector. ncompGridSize Integer. ncompGrid Vector. selectedFeat Vector. nfeatLimits Vector. nfeatGridSize Integer. nfeatV Vector. Kfolds Integer. regMethod Character. labelCode Character. Ncores Integer. seed Integer.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/tunePhiSpace.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — tunePhiSpace","text":"list","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/zeroFeatQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Minimal quality control (QC): remove features with all zero values. — zeroFeatQC","title":"Minimal quality control (QC): remove features with all zero values. — zeroFeatQC","text":"Minimal quality control (QC): remove features zero values.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/zeroFeatQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Minimal quality control (QC): remove features with all zero values. — zeroFeatQC","text":"","code":"zeroFeatQC(sce, assayName = \"counts\")"},{"path":"https://jiadongm.github.io/PhiSpace/reference/zeroFeatQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Minimal quality control (QC): remove features with all zero values. — zeroFeatQC","text":"sce SingleCellExperiment object. assayName Character.","code":""},{"path":"https://jiadongm.github.io/PhiSpace/reference/zeroFeatQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Minimal quality control (QC): remove features with all zero values. — zeroFeatQC","text":"updated SingleCellExperiment object minimal QC.","code":""}]
