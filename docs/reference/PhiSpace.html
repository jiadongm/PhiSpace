<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PhiSpace continuous phenotyping — PhiSpace • PhiSpace</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PhiSpace continuous phenotyping — PhiSpace"><meta property="og:description" content="PhiSpace annotates a query dataset or a list of query datasets, given an annotated bulk or single-cell
RNA-seq references. PhiSpace can simultaneously model multiple layers of cell phenotypes, e.g. cell type and disease condtion."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PhiSpace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/getting_started.html">Getting Started with PhiSpace</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PhiSpace continuous phenotyping</h1>

    <div class="hidden name"><code>PhiSpace.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>PhiSpace annotates a query dataset or a list of query datasets, given an annotated bulk or single-cell
RNA-seq references. PhiSpace can simultaneously model multiple layers of cell phenotypes, e.g. cell type and disease condtion.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PhiSpace</span><span class="op">(</span></span>
<span>  <span class="va">reference</span>,</span>
<span>  <span class="va">query</span>,</span>
<span>  phenotypes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  PhiSpaceAssay <span class="op">=</span> <span class="st">"rank"</span>,</span>
<span>  regMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PLS"</span>, <span class="st">"PCA"</span><span class="op">)</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nfeat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selectedFeat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  DRinfo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  storeUnNorm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  updateRef <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assay2rank <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-reference">reference<a class="anchor" aria-label="anchor" href="#arg-reference"></a></dt>
<dd><p>The references. A <code>SingleCellExperiment</code> (SCE) object or a list of SCE objects. Each must contain an assay named by <code>PhiSpaceAssay</code>.</p></dd>


<dt id="arg-query">query<a class="anchor" aria-label="anchor" href="#arg-query"></a></dt>
<dd><p>The queries. An SCE object or a list of SCE object. Each must contain an assay named by <code>PhiSpaceAssay</code>.</p></dd>


<dt id="arg-phenotypes">phenotypes<a class="anchor" aria-label="anchor" href="#arg-phenotypes"></a></dt>
<dd><p>Which phenotypes (e.g. "cell type") to predict. If <code>NULL</code>, then have to specify <code>response</code>.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>Named matrix. Rows correpond to cells (columns) in reference; columns correspond to phenotypes. If not <code>NULL</code>, then will override <code>phenotypes</code>.</p></dd>


<dt id="arg-phispaceassay">PhiSpaceAssay<a class="anchor" aria-label="anchor" href="#arg-phispaceassay"></a></dt>
<dd><p>Character. Which assay to use to train.</p></dd>


<dt id="arg-regmethod">regMethod<a class="anchor" aria-label="anchor" href="#arg-regmethod"></a></dt>
<dd><p>Character. Regression method: one of "PLS" and "PCA".</p></dd>


<dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p>Integer. Number of components. If <code>NULL</code>, will use the default, i.e. same as the total number of phenotypes.</p></dd>


<dt id="arg-nfeat">nfeat<a class="anchor" aria-label="anchor" href="#arg-nfeat"></a></dt>
<dd><p>Integer. Number of features to choose to predict each phenotype. See details.</p></dd>


<dt id="arg-selectedfeat">selectedFeat<a class="anchor" aria-label="anchor" href="#arg-selectedfeat"></a></dt>
<dd><p>Character. Alternatively, can provide a vector of pre-selected features.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>Logic. Whether to perform centering. See details.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Logic. Whether to perform scaling. See details.</p></dd>


<dt id="arg-drinfo">DRinfo<a class="anchor" aria-label="anchor" href="#arg-drinfo"></a></dt>
<dd><p>Logic. Whether to return dimension reduction information from PCA or PLS. By default disabled to save memory.</p></dd>


<dt id="arg-storeunnorm">storeUnNorm<a class="anchor" aria-label="anchor" href="#arg-storeunnorm"></a></dt>
<dd><p>Store unnormalised raw PhiSpace scores or not. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-updateref">updateRef<a class="anchor" aria-label="anchor" href="#arg-updateref"></a></dt>
<dd><p>Update reference (store reference PhiSpace scores in reference sce object) or not.</p></dd>


<dt id="arg-assay-rank">assay2rank<a class="anchor" aria-label="anchor" href="#arg-assay-rank"></a></dt>
<dd><p>Which assay should be used for rank transform. If not specified, "rank" will be used.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>

<ul><li><p>If <code>updateRef = FALSE</code> (default): An updated query SCE object with PhiSpace annotation results stored in reducedDim slot "PhiSpace";</p></li>
<li><p>If <code>updateRef = TRUE</code>: A list of updated reference and query SCE objects with PhiSpace annotation results stored in reducedDim slot "PhiSpace".</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>

<ul><li><p><strong>Parameter tuning</strong> By default, PhiSpace takes <code>ncomp</code> equal to the total number of phenotypes. For example, if there are
20 cell types and 5 sample sources (e.g. <em>in vivo</em> and <em>in vitro</em>) defined in the reference, <code>ncomp</code> will be set to be 25.
By default, PhiSpace doesn't do any feature selection. However, feature selection is very straightforward in PhiSpace. The partial least squares model automatically rank all features
according to their contribution to predicting each phenotype. For example, if there are 25 phenotypes then PLS will return
25 rankings of all features. Based on this, customised feature selection can be done in two ways. The user either
specify <code>nfeat</code>, i.e. the number of features (or markers) used to predict each phenotype; or specify <code>selectedFeat</code>, i.e.
a subset of features used to predict all phenotypes (e.g. highly variable genes). If <code>nfeat</code> is provided, then <code>selectedFeat</code>
will be automatically defined as the union of the <code>nfeat</code> markers of all phenotypes.</p></li>
<li><p><strong>Center and scale</strong> By default, PhiSpace only center the data but do not scale. This is because we often use more features
than standard single-cell pipelines (e.g. Seurat selects 2,000 highly variable genes) for a better prediction. This means
that we might have included genes with small variance and scaling would greatly inflate the expression levels of these genes.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Mao J., Deng, Y. and Lê Cao, K.-A. (2024).Φ-Space: Continuous phenotyping of single-cell multi-omics data. bioRxiv.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jiadong Mao.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

