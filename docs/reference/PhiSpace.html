<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PhiSpace continuous phenotyping — PhiSpace • PhiSpace</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PhiSpace continuous phenotyping — PhiSpace"><meta name="description" content="PhiSpace annotates a query dataset or a list of query datasets, given an annotated bulk or single-cell
RNA-seq references. PhiSpace can simultaneously model multiple layers of cell phenotypes, e.g. cell type and disease condtion."><meta property="og:description" content="PhiSpace annotates a query dataset or a list of query datasets, given an annotated bulk or single-cell
RNA-seq references. PhiSpace can simultaneously model multiple layers of cell phenotypes, e.g. cell type and disease condtion."><meta property="og:image" content="https://jiadongm.github.io/PhiSpace/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhiSpace</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting_started.html">Getting Started: mapping scRNA-seq to bulk RNA-seq atlas</a></li>
    <li><a class="dropdown-item" href="../articles/CITE-seq.html">Multiomic annotation: using CITE-seq reference to annotate CITE-seq query</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>PhiSpace continuous phenotyping</h1>

      <div class="d-none name"><code>PhiSpace.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>PhiSpace annotates a query dataset or a list of query datasets, given an annotated bulk or single-cell
RNA-seq references. PhiSpace can simultaneously model multiple layers of cell phenotypes, e.g. cell type and disease condtion.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PhiSpace</span><span class="op">(</span></span>
<span>  <span class="va">reference</span>,</span>
<span>  <span class="va">query</span>,</span>
<span>  phenotypes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  PhiSpaceAssay <span class="op">=</span> <span class="st">"rank"</span>,</span>
<span>  regMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PLS"</span>, <span class="st">"PCA"</span><span class="op">)</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nfeat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selectedFeat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  DRinfo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  storeUnNorm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  updateRef <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assay2rank <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-reference">reference<a class="anchor" aria-label="anchor" href="#arg-reference"></a></dt>
<dd><p>The references. A <code>SingleCellExperiment</code> (SCE) object or a list of SCE objects. Each must contain an assay named by <code>PhiSpaceAssay</code>.</p></dd>


<dt id="arg-query">query<a class="anchor" aria-label="anchor" href="#arg-query"></a></dt>
<dd><p>The queries. An SCE object or a list of SCE object. Each must contain an assay named by <code>PhiSpaceAssay</code>.</p></dd>


<dt id="arg-phenotypes">phenotypes<a class="anchor" aria-label="anchor" href="#arg-phenotypes"></a></dt>
<dd><p>Which phenotypes (e.g. "cell type") to predict. If <code>NULL</code>, then have to specify <code>response</code>.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>Named matrix. Rows correpond to cells (columns) in reference; columns correspond to phenotypes. If not <code>NULL</code>, then will override <code>phenotypes</code>.</p></dd>


<dt id="arg-phispaceassay">PhiSpaceAssay<a class="anchor" aria-label="anchor" href="#arg-phispaceassay"></a></dt>
<dd><p>Character. Which assay to use to train.</p></dd>


<dt id="arg-regmethod">regMethod<a class="anchor" aria-label="anchor" href="#arg-regmethod"></a></dt>
<dd><p>Character. Regression method: one of "PLS" and "PCA".</p></dd>


<dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p>Integer. Number of components. If <code>NULL</code>, will use the default, i.e. same as the total number of phenotypes.</p></dd>


<dt id="arg-nfeat">nfeat<a class="anchor" aria-label="anchor" href="#arg-nfeat"></a></dt>
<dd><p>Integer. Number of features to choose to predict each phenotype. See details.</p></dd>


<dt id="arg-selectedfeat">selectedFeat<a class="anchor" aria-label="anchor" href="#arg-selectedfeat"></a></dt>
<dd><p>Character. Alternatively, can provide a vector of pre-selected features.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>Logic. Whether to perform centering. See details.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Logic. Whether to perform scaling. See details.</p></dd>


<dt id="arg-drinfo">DRinfo<a class="anchor" aria-label="anchor" href="#arg-drinfo"></a></dt>
<dd><p>Logic. Whether to return dimension reduction information from PCA or PLS. By default disabled to save memory.</p></dd>


<dt id="arg-storeunnorm">storeUnNorm<a class="anchor" aria-label="anchor" href="#arg-storeunnorm"></a></dt>
<dd><p>Store unnormalised raw PhiSpace scores or not. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-updateref">updateRef<a class="anchor" aria-label="anchor" href="#arg-updateref"></a></dt>
<dd><p>Update reference (store reference PhiSpace scores in reference sce object) or not.</p></dd>


<dt id="arg-assay-rank">assay2rank<a class="anchor" aria-label="anchor" href="#arg-assay-rank"></a></dt>
<dd><p>Which assay should be used for rank transform. If not specified, "rank" will be used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p>If <code>updateRef = FALSE</code> (default): An updated query SCE object with PhiSpace annotation results stored in reducedDim slot "PhiSpace";</p></li>
<li><p>If <code>updateRef = TRUE</code>: A list of updated reference and query SCE objects with PhiSpace annotation results stored in reducedDim slot "PhiSpace".</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p><strong>Parameter tuning</strong> By default, PhiSpace takes <code>ncomp</code> equal to the total number of phenotypes. For example, if there are
20 cell types and 5 sample sources (e.g. <em>in vivo</em> and <em>in vitro</em>) defined in the reference, <code>ncomp</code> will be set to be 25.
By default, PhiSpace doesn't do any feature selection. However, feature selection is very straightforward in PhiSpace. The partial least squares model automatically rank all features
according to their contribution to predicting each phenotype. For example, if there are 25 phenotypes then PLS will return
25 rankings of all features. Based on this, customised feature selection can be done in two ways. The user either
specify <code>nfeat</code>, i.e. the number of features (or markers) used to predict each phenotype; or specify <code>selectedFeat</code>, i.e.
a subset of features used to predict all phenotypes (e.g. highly variable genes). If <code>nfeat</code> is provided, then <code>selectedFeat</code>
will be automatically defined as the union of the <code>nfeat</code> markers of all phenotypes.</p></li>
<li><p><strong>Center and scale</strong> By default, PhiSpace only center the data but do not scale. This is because we often use more features
than standard single-cell pipelines (e.g. Seurat selects 2,000 highly variable genes) for a better prediction. This means
that we might have included genes with small variance and scaling would greatly inflate the expression levels of these genes.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mao J., Deng, Y. and Lê Cao, K.-A. (2024).Φ-Space: Continuous phenotyping of single-cell multi-omics data. bioRxiv.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jiadong Mao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

